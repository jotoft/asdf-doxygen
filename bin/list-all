#!/usr/bin/env bash

set -euo pipefail

# List all available doxygen versions from GitHub releases
# Set up authentication header if GITHUB_API_TOKEN is available
if [ -n "${GITHUB_API_TOKEN:-}" ]; then
  AUTH_HEADER="Authorization: token ${GITHUB_API_TOKEN}"
elif [ -n "${GITHUB_TOKEN:-}" ]; then
  AUTH_HEADER="Authorization: token ${GITHUB_TOKEN}"
else
  AUTH_HEADER=""
fi

# Fetch releases and extract versions (portable across Linux and macOS)
if [ -n "$AUTH_HEADER" ]; then
  curl -s -H "$AUTH_HEADER" https://api.github.com/repos/doxygen/doxygen/releases
else
  curl -s https://api.github.com/repos/doxygen/doxygen/releases
fi | sed -n 's/.*"tag_name": "Release_\([^"]*\)".*/\1/p' | tr '_' '.' | tr '\n' ' '
